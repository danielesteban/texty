syntax = "proto3";

message NodeMessageResponses {
  string text = 1;
  optional string next = 2;
}

message NodeMessage {
  string text = 1;
  repeated NodeMessageResponses responses = 2;
}

message NodeResolution {
  string message = 1;
  string result = 2;
  bool status = 3;
}

message NodeScenario {
  string creator = 1;
  string description = 2;
  Language language = 3;
  string name = 4;
  bytes photo = 5;
  bool private = 6;
  optional string start = 7;
  repeated string collaborators = 8;
}

message NodePosition {
  int32 x = 1;
  int32 y = 2;
}

message Node {
  string id = 1;
  NodePosition position = 2;
  oneof type {
    NodeMessage message = 3;
    NodeResolution resolution = 4;
    NodeScenario scenario = 5;
  }
}

message Scenario {
  repeated Node nodes = 1;
}

// Actions

message SetBytes {
  string id = 0;
  bytes value = 1;
}

message SetChildString {
  string id = 0;
  uint32 child = 1;
  string value = 2;
}

message SetLanguage {
  string id = 0;
  Language value = 1;
}

message SetPosition {
  string id = 0;
  NodePosition value = 1;
}

message SetString {
  string id = 0;
  string value = 1;
}

message SetBool {
  string id = 0;
  bool value = 1;
}

message Action {
  oneof type {
    Node create = 0;
    string remove = 1;
    SetPosition setPosition = 2;
    SetString setMessageText = 3;
    SetChildString setMessageReponseText = 4;
    SetChildString setMessageReponseNext = 5;
    SetString setResolutionMessage = 6;
    SetString setResolutionResult = 7;
    SetBool setResolutionStatus = 8;
    SetString addScenarioCollaborator = 9;
    SetString removeScenarioCollaborator = 10;
    SetString setScenarioDescription = 11;
    SetLanguage setScenarioLanguage = 12;
    SetString setScenarioName = 13;
    SetBytes setScenarioPhoto = 14;
    SetBool setScenarioPrivate = 15;
    SetString setScenarioStart = 16;
  }
}

enum Language {
  AA = 0;
  AF = 1;
  AM = 2;
  AR = 3;
  AY = 4;
  AZ = 5;
  BE = 6;
  BG = 7;
  BI = 8;
  BN = 9;
  BS = 10;
  CA = 11;
  CH = 12;
  CS = 13;
  DA = 14;
  DE = 15;
  DV = 16;
  DZ = 17;
  EL = 18;
  EN = 19;
  ES = 20;
  ET = 21;
  FA = 22;
  FF = 23;
  FI = 24;
  FJ = 25;
  FO = 26;
  FR = 27;
  GA = 28;
  GN = 29;
  GV = 30;
  HE = 31;
  HI = 32;
  HR = 33;
  HT = 34;
  HU = 35;
  HY = 36;
  ID = 37;
  IS = 38;
  IT = 39;
  JA = 40;
  KA = 41;
  KG = 42;
  KK = 43;
  KL = 44;
  KM = 45;
  KO = 46;
  KU = 47;
  KY = 48;
  LA = 49;
  LB = 50;
  LN = 51;
  LO = 52;
  LT = 53;
  LU = 54;
  LV = 55;
  MG = 56;
  MH = 57;
  MI = 58;
  MK = 59;
  MN = 60;
  MS = 61;
  MT = 62;
  MY = 63;
  NA = 64;
  NB = 65;
  ND = 66;
  NE = 67;
  NL = 68;
  NN = 69;
  NO = 70;
  NR = 71;
  NY = 72;
  PA = 73;
  PL = 74;
  PS = 75;
  PT = 76;
  QU = 77;
  RM = 78;
  RN = 79;
  RO = 80;
  RU = 81;
  RW = 82;
  SG = 83;
  SI = 84;
  SK = 85;
  SL = 86;
  SM = 87;
  SN = 88;
  SO = 89;
  SQ = 90;
  SR = 91;
  SS = 92;
  ST = 93;
  SV = 94;
  SW = 95;
  TA = 96;
  TG = 97;
  TH = 98;
  TI = 99;
  TK = 100;
  TN = 101;
  TO = 102;
  TR = 103;
  TS = 104;
  UK = 105;
  UR = 106;
  UZ = 107;
  VE = 108;
  VI = 109;
  XH = 110;
  ZH = 111;
  ZU = 112;
}
